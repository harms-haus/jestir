# Story 1.4: Story Writing Pipeline

**Status:** In Progress
**Epic:** 1 - Foundation & Core Pipeline
**Story ID:** 1.4
**Title:** Story Writing Pipeline
**Slug:** story-writing-pipeline

## Story

As a parent,
I want to generate the final story from an approved outline,
so that I have a complete bedtime story ready to read.

## Acceptance Criteria

1. CLI command `jestir write outline.md` creates story.md
2. OpenAI API call uses outline and context for story generation
3. Template system reads story_template.txt with {{key}} substitutions
4. Plain markdown output with proper paragraph formatting
5. Context file updated with generated story content
6. Reading time estimation displayed after generation
7. Word count displayed after generation

## Tasks/Subtasks

- [ ] Implement story writing service
- [ ] Create story template system
- [ ] Add OpenAI API integration for story generation
- [ ] Implement reading time calculation
- [ ] Add word count functionality
- [ ] Create CLI command for story writing
- [ ] Update context file with generated story
- [ ] Add proper error handling and validation

## Dev Notes

This is the final stage of the core pipeline, generating the actual bedtime story from the approved outline. It depends on both context generation (1.2) and outline generation (1.3) being completed.

## Testing

- Test story generation with various outline formats
- Verify template substitution works correctly
- Test reading time and word count calculations
- Validate context file updates
- Test error handling for malformed inputs

## QA Results

**Gate Decision**: PENDING
**Review Date**: TBD
**Reviewer**: TBD

**Risk Assessment**: TBD
**Risk Score**: TBD

**Key Findings**: TBD

**Recommendations**: TBD

**Risk Assessment**: [docs/qa/assessments/1.4-story-writing-pipeline-risk-20241219.md](docs/qa/assessments/1.4-story-writing-pipeline-risk-20241219.md)
**Gate File**: [docs/qa/gates/1.4-story-writing-pipeline.yml](docs/qa/gates/1.4-story-writing-pipeline.yml)

## Change Log

- Initial creation
